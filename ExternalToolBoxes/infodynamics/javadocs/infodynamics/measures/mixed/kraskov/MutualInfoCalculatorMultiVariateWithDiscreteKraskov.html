<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.20) on Tue Aug 22 13:03:51 AEST 2023 -->
<title>MutualInfoCalculatorMultiVariateWithDiscreteKraskov</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2023-08-22">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../jquery/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-ui.min.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="MutualInfoCalculatorMultiVariateWithDiscreteKraskov";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":10,"i20":10,"i21":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">infodynamics.measures.mixed.kraskov</a></div>
<h2 title="Class MutualInfoCalculatorMultiVariateWithDiscreteKraskov" class="title">Class MutualInfoCalculatorMultiVariateWithDiscreteKraskov</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>infodynamics.measures.mixed.kraskov.MutualInfoCalculatorMultiVariateWithDiscreteKraskov</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html" title="interface in infodynamics.measures.mixed">MutualInfoCalculatorMultiVariateWithDiscrete</a></code>, <code>java.lang.Cloneable</code></dd>
</dl>
<hr>
<pre>public class <span class="typeNameLabel">MutualInfoCalculatorMultiVariateWithDiscreteKraskov</span>
extends java.lang.Object
implements <a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html" title="interface in infodynamics.measures.mixed">MutualInfoCalculatorMultiVariateWithDiscrete</a>, java.lang.Cloneable</pre>
<div class="block"><p>Compute the Mutual Information between a vector of continuous variables and discrete
  variable using the Kraskov estimation method.</p>
 <p>Uses Kraskov method type 2, since type 1 only looks at points with
 distances strictly less than the kth variable, which won't work for one marginal
 being discrete.</p>
 <p>I have noticed that there are quite large bias negative values here
 where small K is used (e.g. for binary data splitting continuous into
 two distinct groups, 1400 observations, K=4 has bias ~ -.35)</p>
 
 <p>These calculators are <b>EXPERIMENTAL</b> -- not properly tested,
 and not well documented. The intended calling pattern is similar to
 <a href="../../continuous/MutualInfoCalculatorMultiVariate.html" title="interface in infodynamics.measures.continuous"><code>MutualInfoCalculatorMultiVariate</code></a>
 </p>
 
 <p>This calculator effectively implements the nearest neighbour method
 laid out <a href="http://journals.plos.org/plosone/article?id=10.1371%2Fjournal.pone.0087357">here</a>
 (see Ross reference below),
 but we have subtract out the sample point from the count in the discrete space,
 following the original KSG method.
 </p>
 
 <p><b>References:</b><br/>
 <ul>
        <li> B.C. Ross, "Mutual Information between Discrete and Continuous Data Sets",
        PLoS ONE 9(2): e87357. doi:
 <a href="http://journals.plos.org/plosone/article?id=10.1371%2Fjournal.pone.0087357">10.1371/journal.pone.0087357</a></li>
 </ul></div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>Joseph Lizier (<a href="joseph.lizier at gmail.com">email</a>,
 <a href="http://lizier.me/joseph/">www</a>), Pedro A.M. Mediano (<a href="pmediano at imperial.ac.uk">email</a>,
 <a href="http://www.doc.ic.ac.uk/~pam213">www</a>)</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addNoise">addNoise</a></span></code></th>
<td class="colLast">
<div class="block">Whether to add an amount of random noise to the incoming data</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#base">base</a></span></code></th>
<td class="colLast">
<div class="block">Number of possible states of the discrete variable</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected double[][]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#continuousData">continuousData</a></span></code></th>
<td class="colLast">
<div class="block">The set of continuous data observations, retained in case the user wants
 to retrieve the local entropy values of these.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected int[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#counts">counts</a></span></code></th>
<td class="colLast">
<div class="block">Counts of how many observations belong to each discrete bin.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#debug">debug</a></span></code></th>
<td class="colLast">
<div class="block">Whether to print debug information</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#digammaK">digammaK</a></span></code></th>
<td class="colLast">
<div class="block">Saved digammaK for average and local computations</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#digammaN">digammaN</a></span></code></th>
<td class="colLast">
<div class="block">Saved digammaN for average and local computations</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#dimensions">dimensions</a></span></code></th>
<td class="colLast">
<div class="block">Number of dimenions of the joint continuous variable</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected int[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#discreteData">discreteData</a></span></code></th>
<td class="colLast">
<div class="block">The set of discrete data observations, retained in case the user wants
 to retrieve the local entropy values of these.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#dynCorrExclTime">dynCorrExclTime</a></span></code></th>
<td class="colLast">
<div class="block">Size of dynamic correlation exclusion window.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#k">k</a></span></code></th>
<td class="colLast">
<div class="block">we compute distances to the kth neighbour</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="../../../utils/KdTree.html" title="class in infodynamics.utils">KdTree</a>[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#kdTreeBins">kdTreeBins</a></span></code></th>
<td class="colLast">
<div class="block">KdTrees for neighbour searches in binned continuous datasets</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../../utils/KdTree.html" title="class in infodynamics.utils">KdTree</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#kdTreeJoint">kdTreeJoint</a></span></code></th>
<td class="colLast">
<div class="block">KdTree for range searches in full continuous dataset</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected double[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#means">means</a></span></code></th>
<td class="colLast">
<div class="block">Track the means of the joint variables if we are normalising them</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#mi">mi</a></span></code></th>
<td class="colLast">
<div class="block">Last computed value of MI</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#miComputed">miComputed</a></span></code></th>
<td class="colLast">
<div class="block">Whether MI has been computed with the current observations</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#noiseLevel">noiseLevel</a></span></code></th>
<td class="colLast">
<div class="block">Amount of random Gaussian noise to add to the incoming data</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#normalise">normalise</a></span></code></th>
<td class="colLast">
<div class="block">Track whether we're going to normalise the joint variables individually</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#normType">normType</a></span></code></th>
<td class="colLast">
<div class="block">The norm type in use (see <a href="#PROP_NORM_TYPE"><code>PROP_NORM_TYPE</code></a>)</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_ADD_NOISE">PROP_ADD_NOISE</a></span></code></th>
<td class="colLast">
<div class="block">Property name for an amount of random Gaussian noise to be
  added to the data (default is 1e-8, matching the MILCA toolkit).</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_K">PROP_K</a></span></code></th>
<td class="colLast">
<div class="block">Property name for the number of K nearest neighbours used in
 the KSG algorithm in the full joint space (default 4).</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_NORM_TYPE">PROP_NORM_TYPE</a></span></code></th>
<td class="colLast">
<div class="block">Property name for what type of norm to use between data points
  for each marginal variable -- Options are defined by 
  <a href="../../../utils/KdTree.html#setNormType(java.lang.String)"><code>KdTree.setNormType(String)</code></a> and the
  default is <a href="../../../utils/EuclideanUtils.html#NORM_MAX_NORM"><code>EuclideanUtils.NORM_MAX_NORM</code></a>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_NORMALISE">PROP_NORMALISE</a></span></code></th>
<td class="colLast">
<div class="block">Property name for whether to normalise the incoming data to 
 mean 0, standard deviation 1 (default true)</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_TIME_DIFF">PROP_TIME_DIFF</a></span></code></th>
<td class="colLast">
<div class="block">Property name for time difference between source and destination (0 by default,
 must be >= 0)</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected double[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#stds">stds</a></span></code></th>
<td class="colLast">
<div class="block">Track the std devs of the joint variables if we are normalising them</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#timeDiff">timeDiff</a></span></code></th>
<td class="colLast">
<div class="block">Time difference from the source to the destination observations
  (ie destination lags the source by this time:
        we compute I(source_{n}; dest_{n+timeDiff}).</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#totalObservations">totalObservations</a></span></code></th>
<td class="colLast">
<div class="block">Number of observations added to the calculator</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected java.util.Vector&lt;double[][]&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#vectorOfContinuousObservations">vectorOfContinuousObservations</a></span></code></th>
<td class="colLast">
<div class="block">Storage for continuous observations supplied via <a href="#addObservations(double%5B%5D%5B%5D,int%5B%5D)"><code>addObservations(double[][], int[])</code></a>
 type calls</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.util.Vector&lt;int[]&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#vectorOfDiscreteObservations">vectorOfDiscreteObservations</a></span></code></th>
<td class="colLast">
<div class="block">Storage for discrete observations supplied via <a href="#addObservations(double%5B%5D%5B%5D,int%5B%5D)"><code>addObservations(double[][], int[])</code></a>
 type calls</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E()">MutualInfoCalculatorMultiVariateWithDiscreteKraskov</a></span>()</code></th>
<td class="colLast">
<div class="block">Construct an instance of the KSG mixed MI calculator</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addObservations(double%5B%5D%5B%5D,double%5B%5D%5B%5D,int,int)">addObservations</a></span>&#8203;(double[][]&nbsp;source,
               double[][]&nbsp;destination,
               int&nbsp;startTime,
               int&nbsp;numTimeSteps)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addObservations(double%5B%5D%5B%5D,int%5B%5D)">addObservations</a></span>&#8203;(double[][]&nbsp;continuousObservations,
               int[]&nbsp;discreteObservations)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addObservations(double%5B%5D,int%5B%5D)">addObservations</a></span>&#8203;(double[]&nbsp;continuousObservations,
               int[]&nbsp;discreteObservations)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#computeAverageLocalOfObservations()">computeAverageLocalOfObservations</a></span>()</code></th>
<td class="colLast">
<div class="block">Calculate the average MI in nats.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#computeAverageLocalOfObservations(int%5B%5D)">computeAverageLocalOfObservations</a></span>&#8203;(int[]&nbsp;newOrdering)</code></th>
<td class="colLast">
<div class="block">Compute what the average MI would look like were the second time series reordered
  as per the array of time indices in reordering.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>protected double[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#computeFromObservations(boolean)">computeFromObservations</a></span>&#8203;(boolean&nbsp;returnLocals)</code></th>
<td class="colLast">
<div class="block">This protected method handles the computation of either the average or
 local MI (over parts of the total observations).</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>double[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#computeLocalOfPreviousObservations()">computeLocalOfPreviousObservations</a></span>()</code></th>
<td class="colLast">
<div class="block">Computes the local values of the MI,
  for each valid observation in the previously supplied observations
  (with PDFs computed using all of the previously supplied observation sets).</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>double[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#computeLocalUsingPreviousObservations(double%5B%5D%5B%5D,int%5B%5D)">computeLocalUsingPreviousObservations</a></span>&#8203;(double[][]&nbsp;continuousNewStates,
                                     int[]&nbsp;discreteNewStates)</code></th>
<td class="colLast">
<div class="block">Compute the local MI values for the given observations,
  using the previously set observations to compute the PDFs.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code><a href="../../../utils/EmpiricalMeasurementDistribution.html" title="class in infodynamics.utils">EmpiricalMeasurementDistribution</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#computeSignificance(int)">computeSignificance</a></span>&#8203;(int&nbsp;numPermutationsToCheck)</code></th>
<td class="colLast">
<div class="block">Compute the significance of the mutual information of the previously
 supplied observations.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code><a href="../../../utils/EmpiricalMeasurementDistribution.html" title="class in infodynamics.utils">EmpiricalMeasurementDistribution</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#computeSignificance(int%5B%5D%5B%5D)">computeSignificance</a></span>&#8203;(int[][]&nbsp;newOrderings)</code></th>
<td class="colLast">
<div class="block">Compute the significance of the mutual information of the previously
 supplied observations.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#ensureKdTreesConstructed()">ensureKdTreesConstructed</a></span>()</code></th>
<td class="colLast">
<div class="block">Internal method to ensure that the Kd-tree data structures to represent the
 observational data have been constructed (should be called prior to attempting
 to use these data structures)</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#finaliseAddObservations()">finaliseAddObservations</a></span>()</code></th>
<td class="colLast">
<div class="block">Prepare observations previously added through any addObservations method
 for calculations.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getLastAverage()">getLastAverage</a></span>()</code></th>
<td class="colLast">
<div class="block">Return the MI last calculated in a call to <a href="#computeAverageLocalOfObservations()"><code>computeAverageLocalOfObservations()</code></a>
 or <a href="#computeLocalOfPreviousObservations()"><code>computeLocalOfPreviousObservations()</code></a> after the previous
 <code>#initialise()</code> call.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getNumObservations()">getNumObservations</a></span>()</code></th>
<td class="colLast">
<div class="block">Get the number of samples to be used for the PDFs here 
 which have been supplied by calls to
 <a href="#setObservations(double%5B%5D%5B%5D,int%5B%5D)"><code>setObservations(double[][], int[])</code></a>,
 <a href="#addObservations(double%5B%5D%5B%5D,int%5B%5D)"><code>addObservations(double[][], int[])</code></a>
 etc.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#initialise(int,int)">initialise</a></span>&#8203;(int&nbsp;dimensions,
          int&nbsp;base)</code></th>
<td class="colLast">
<div class="block">Initialise the calculator.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setDebug(boolean)">setDebug</a></span>&#8203;(boolean&nbsp;debug)</code></th>
<td class="colLast">
<div class="block">Set whether to print extra debug messages</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setObservations(double%5B%5D%5B%5D,double%5B%5D%5B%5D,boolean%5B%5D%5B%5D,boolean%5B%5D%5B%5D)">setObservations</a></span>&#8203;(double[][]&nbsp;source,
               double[][]&nbsp;destination,
               boolean[][]&nbsp;sourceValid,
               boolean[][]&nbsp;destValid)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setObservations(double%5B%5D%5B%5D,double%5B%5D%5B%5D,boolean%5B%5D,boolean%5B%5D)">setObservations</a></span>&#8203;(double[][]&nbsp;source,
               double[][]&nbsp;destination,
               boolean[]&nbsp;sourceValid,
               boolean[]&nbsp;destValid)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setObservations(double%5B%5D%5B%5D,int%5B%5D)">setObservations</a></span>&#8203;(double[][]&nbsp;continuousObservations,
               int[]&nbsp;discreteObservations)</code></th>
<td class="colLast">
<div class="block">Set the properties from which the mutual information should be computed.</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setObservations(double%5B%5D,int%5B%5D)">setObservations</a></span>&#8203;(double[]&nbsp;continuousObservations,
               int[]&nbsp;discreteObservations)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setProperty(java.lang.String,java.lang.String)">setProperty</a></span>&#8203;(java.lang.String&nbsp;propertyName,
           java.lang.String&nbsp;propertyValue)</code></th>
<td class="colLast">
<div class="block">Sets properties for the calculator.</div>
</td>
</tr>
<tr id="i21" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#startAddObservations()">startAddObservations</a></span>()</code></th>
<td class="colLast">
<div class="block">Prepare the calculator to receive observations.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a id="k">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>k</h4>
<pre>protected&nbsp;int k</pre>
<div class="block">we compute distances to the kth neighbour</div>
</li>
</ul>
<a id="continuousData">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>continuousData</h4>
<pre>protected&nbsp;double[][] continuousData</pre>
<div class="block">The set of continuous data observations, retained in case the user wants
 to retrieve the local entropy values of these.
 They're held in the order in which they were supplied in the
  <a href="#addObservations(double%5B%5D%5B%5D,int%5B%5D)"><code>addObservations(double[][],int[])</code></a> functions.</div>
</li>
</ul>
<a id="discreteData">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>discreteData</h4>
<pre>protected&nbsp;int[] discreteData</pre>
<div class="block">The set of discrete data observations, retained in case the user wants
 to retrieve the local entropy values of these.
 They're held in the order in which they were supplied in the
  <a href="#addObservations(double%5B%5D%5B%5D,int%5B%5D)"><code>addObservations(double[][],int[])</code></a> functions.</div>
</li>
</ul>
<a id="counts">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>counts</h4>
<pre>protected&nbsp;int[] counts</pre>
<div class="block">Counts of how many observations belong to each discrete bin.</div>
</li>
</ul>
<a id="base">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>base</h4>
<pre>protected&nbsp;int base</pre>
<div class="block">Number of possible states of the discrete variable</div>
</li>
</ul>
<a id="dimensions">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>dimensions</h4>
<pre>protected&nbsp;int dimensions</pre>
<div class="block">Number of dimenions of the joint continuous variable</div>
</li>
</ul>
<a id="totalObservations">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>totalObservations</h4>
<pre>protected&nbsp;int totalObservations</pre>
<div class="block">Number of observations added to the calculator</div>
</li>
</ul>
<a id="debug">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>debug</h4>
<pre>protected&nbsp;boolean debug</pre>
<div class="block">Whether to print debug information</div>
</li>
</ul>
<a id="mi">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mi</h4>
<pre>protected&nbsp;double mi</pre>
<div class="block">Last computed value of MI</div>
</li>
</ul>
<a id="miComputed">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>miComputed</h4>
<pre>protected&nbsp;boolean miComputed</pre>
<div class="block">Whether MI has been computed with the current observations</div>
</li>
</ul>
<a id="digammaN">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>digammaN</h4>
<pre>protected&nbsp;double digammaN</pre>
<div class="block">Saved digammaN for average and local computations</div>
</li>
</ul>
<a id="digammaK">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>digammaK</h4>
<pre>protected&nbsp;double digammaK</pre>
<div class="block">Saved digammaK for average and local computations</div>
</li>
</ul>
<a id="vectorOfContinuousObservations">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>vectorOfContinuousObservations</h4>
<pre>protected&nbsp;java.util.Vector&lt;double[][]&gt; vectorOfContinuousObservations</pre>
<div class="block">Storage for continuous observations supplied via <a href="#addObservations(double%5B%5D%5B%5D,int%5B%5D)"><code>addObservations(double[][], int[])</code></a>
 type calls</div>
</li>
</ul>
<a id="vectorOfDiscreteObservations">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>vectorOfDiscreteObservations</h4>
<pre>protected&nbsp;java.util.Vector&lt;int[]&gt; vectorOfDiscreteObservations</pre>
<div class="block">Storage for discrete observations supplied via <a href="#addObservations(double%5B%5D%5B%5D,int%5B%5D)"><code>addObservations(double[][], int[])</code></a>
 type calls</div>
</li>
</ul>
<a id="kdTreeJoint">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>kdTreeJoint</h4>
<pre>protected&nbsp;<a href="../../../utils/KdTree.html" title="class in infodynamics.utils">KdTree</a> kdTreeJoint</pre>
<div class="block">KdTree for range searches in full continuous dataset</div>
</li>
</ul>
<a id="kdTreeBins">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>kdTreeBins</h4>
<pre>protected&nbsp;<a href="../../../utils/KdTree.html" title="class in infodynamics.utils">KdTree</a>[] kdTreeBins</pre>
<div class="block">KdTrees for neighbour searches in binned continuous datasets</div>
</li>
</ul>
<a id="normType">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>normType</h4>
<pre>protected&nbsp;int normType</pre>
<div class="block">The norm type in use (see <a href="#PROP_NORM_TYPE"><code>PROP_NORM_TYPE</code></a>)</div>
</li>
</ul>
<a id="PROP_K">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_K</h4>
<pre>public static final&nbsp;java.lang.String PROP_K</pre>
<div class="block">Property name for the number of K nearest neighbours used in
 the KSG algorithm in the full joint space (default 4).</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#infodynamics.measures.mixed.kraskov.MutualInfoCalculatorMultiVariateWithDiscreteKraskov.PROP_K">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROP_NORM_TYPE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_NORM_TYPE</h4>
<pre>public static final&nbsp;java.lang.String PROP_NORM_TYPE</pre>
<div class="block">Property name for what type of norm to use between data points
  for each marginal variable -- Options are defined by 
  <a href="../../../utils/KdTree.html#setNormType(java.lang.String)"><code>KdTree.setNormType(String)</code></a> and the
  default is <a href="../../../utils/EuclideanUtils.html#NORM_MAX_NORM"><code>EuclideanUtils.NORM_MAX_NORM</code></a>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#infodynamics.measures.mixed.kraskov.MutualInfoCalculatorMultiVariateWithDiscreteKraskov.PROP_NORM_TYPE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROP_NORMALISE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_NORMALISE</h4>
<pre>public static final&nbsp;java.lang.String PROP_NORMALISE</pre>
<div class="block">Property name for whether to normalise the incoming data to 
 mean 0, standard deviation 1 (default true)</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#infodynamics.measures.mixed.kraskov.MutualInfoCalculatorMultiVariateWithDiscreteKraskov.PROP_NORMALISE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROP_TIME_DIFF">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_TIME_DIFF</h4>
<pre>public static final&nbsp;java.lang.String PROP_TIME_DIFF</pre>
<div class="block">Property name for time difference between source and destination (0 by default,
 must be >= 0)</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#infodynamics.measures.mixed.kraskov.MutualInfoCalculatorMultiVariateWithDiscreteKraskov.PROP_TIME_DIFF">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROP_ADD_NOISE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_ADD_NOISE</h4>
<pre>public static final&nbsp;java.lang.String PROP_ADD_NOISE</pre>
<div class="block">Property name for an amount of random Gaussian noise to be
  added to the data (default is 1e-8, matching the MILCA toolkit).</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#infodynamics.measures.mixed.kraskov.MutualInfoCalculatorMultiVariateWithDiscreteKraskov.PROP_ADD_NOISE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="normalise">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>normalise</h4>
<pre>protected&nbsp;boolean normalise</pre>
<div class="block">Track whether we're going to normalise the joint variables individually</div>
</li>
</ul>
<a id="means">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>means</h4>
<pre>protected&nbsp;double[] means</pre>
<div class="block">Track the means of the joint variables if we are normalising them</div>
</li>
</ul>
<a id="stds">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stds</h4>
<pre>protected&nbsp;double[] stds</pre>
<div class="block">Track the std devs of the joint variables if we are normalising them</div>
</li>
</ul>
<a id="timeDiff">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>timeDiff</h4>
<pre>protected&nbsp;int timeDiff</pre>
<div class="block">Time difference from the source to the destination observations
  (ie destination lags the source by this time:
        we compute I(source_{n}; dest_{n+timeDiff}).
 (Note that our internal sourceObservations and destObservations
  are adjusted so that there is no timeDiff between them).</div>
</li>
</ul>
<a id="addNoise">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addNoise</h4>
<pre>protected&nbsp;boolean addNoise</pre>
<div class="block">Whether to add an amount of random noise to the incoming data</div>
</li>
</ul>
<a id="noiseLevel">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>noiseLevel</h4>
<pre>protected&nbsp;double noiseLevel</pre>
<div class="block">Amount of random Gaussian noise to add to the incoming data</div>
</li>
</ul>
<a id="dynCorrExclTime">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>dynCorrExclTime</h4>
<pre>protected&nbsp;int dynCorrExclTime</pre>
<div class="block">Size of dynamic correlation exclusion window. By default is set to 0.

 NOTE non-zero exclusion windows are not yet supported in mixed calculators.</div>
</li>
</ul>
</li>
</ul>
</section>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>MutualInfoCalculatorMultiVariateWithDiscreteKraskov</h4>
<pre>public&nbsp;MutualInfoCalculatorMultiVariateWithDiscreteKraskov()</pre>
<div class="block">Construct an instance of the KSG mixed MI calculator</div>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="initialise(int,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initialise</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;initialise&#8203;(int&nbsp;dimensions,
                       int&nbsp;base)</pre>
<div class="block">Initialise the calculator.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html#initialise(int,int)">initialise</a></code>&nbsp;in interface&nbsp;<code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html" title="interface in infodynamics.measures.mixed">MutualInfoCalculatorMultiVariateWithDiscrete</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dimensions</code> - number of joint continuous variables</dd>
<dd><code>base</code> - number of discrete states</dd>
</dl>
</li>
</ul>
<a id="setProperty(java.lang.String,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setProperty</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setProperty&#8203;(java.lang.String&nbsp;propertyName,
                        java.lang.String&nbsp;propertyValue)
                 throws java.lang.Exception</pre>
<div class="block">Sets properties for the calculator.
 Valid properties include:
 <ul>
  <li><a href="#PROP_K"><code>PROP_K</code></a> - number of neighbouring points in joint kernel space (default 4)</li>
        <li><a href="#PROP_NORM_TYPE"><code>PROP_NORM_TYPE</code></a></li> - normalization type to apply to 
                working out the norms between the points in each marginal space.
                Options are defined by <a href="../../../utils/EuclideanUtils.html#setNormToUse(java.lang.String)"><code>EuclideanUtils.setNormToUse(String)</code></a> -
                default is <a href="../../../utils/EuclideanUtils.html#NORM_MAX_NORM"><code>EuclideanUtils.NORM_MAX_NORM</code></a>.
  <li><a href="#PROP_NORMALISE"><code>PROP_NORMALISE</code></a> - whether to normalise the individual
      variables (true by default)</li>
        <li><a href="#PROP_TIME_DIFF"><code>PROP_TIME_DIFF</code></a> - Time difference between source and
        destination (0 by default). Must be >= 0.</li>
  <li><a href="#PROP_ADD_NOISE"><code>PROP_ADD_NOISE</code></a> -- a standard deviation for an amount of
    random Gaussian noise to add to
      each variable, to avoid having neighbourhoods with artificially
      large counts. (We also accept "false" to indicate "0".)
      The amount is added in after any normalisation,
      so can be considered as a number of standard deviations of the data.
      (Recommended by Kraskov. MILCA uses 1e-8; but adds in
      a random amount of noise in [0,noiseLevel) ).
      Default 1e-8 to match the noise order in MILCA toolkit.</li>
  <li><code>#PROP_DYN_CORR_EXCL_TIME</code> -- a dynamics exclusion time window,
      also known as Theiler window (see Kantz and Schreiber);
      default is 0 which means no dynamic exclusion window.</li>
 </ul></div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html#setProperty(java.lang.String,java.lang.String)">setProperty</a></code>&nbsp;in interface&nbsp;<code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html" title="interface in infodynamics.measures.mixed">MutualInfoCalculatorMultiVariateWithDiscrete</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>propertyName</code> - name of the property to set</dd>
<dd><code>propertyValue</code> - value to set on that property</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</li>
</ul>
<a id="addObservations(double[][],int[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addObservations</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;addObservations&#8203;(double[][]&nbsp;continuousObservations,
                            int[]&nbsp;discreteObservations)
                     throws java.lang.Exception</pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</li>
</ul>
<a id="addObservations(double[],int[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addObservations</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;addObservations&#8203;(double[]&nbsp;continuousObservations,
                            int[]&nbsp;discreteObservations)
                     throws java.lang.Exception</pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</li>
</ul>
<a id="addObservations(double[][],double[][],int,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addObservations</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;addObservations&#8203;(double[][]&nbsp;source,
                            double[][]&nbsp;destination,
                            int&nbsp;startTime,
                            int&nbsp;numTimeSteps)
                     throws java.lang.Exception</pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</li>
</ul>
<a id="setObservations(double[][],double[][],boolean[],boolean[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setObservations</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setObservations&#8203;(double[][]&nbsp;source,
                            double[][]&nbsp;destination,
                            boolean[]&nbsp;sourceValid,
                            boolean[]&nbsp;destValid)
                     throws java.lang.Exception</pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</li>
</ul>
<a id="setObservations(double[][],double[][],boolean[][],boolean[][])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setObservations</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setObservations&#8203;(double[][]&nbsp;source,
                            double[][]&nbsp;destination,
                            boolean[][]&nbsp;sourceValid,
                            boolean[][]&nbsp;destValid)
                     throws java.lang.Exception</pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</li>
</ul>
<a id="startAddObservations()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>startAddObservations</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;startAddObservations()</pre>
<div class="block">Prepare the calculator to receive observations.

 Must be called between <code>#initialise()</code> and any addObservations
 method. Does not need to be called if
 <a href="#setObservations(double%5B%5D%5B%5D,int%5B%5D)"><code>setObservations(double[][],int[])</code></a> is used.</div>
</li>
</ul>
<a id="finaliseAddObservations()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>finaliseAddObservations</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;finaliseAddObservations()
                             throws java.lang.Exception</pre>
<div class="block">Prepare observations previously added through any addObservations method
 for calculations.

 Must be called between any addObservations method and any compute method.
 Does not need to be called if <a href="#setObservations(double%5B%5D%5B%5D,int%5B%5D)"><code>setObservations(double[][],int[])</code></a>
 is used.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</li>
</ul>
<a id="setObservations(double[][],int[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setObservations</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setObservations&#8203;(double[][]&nbsp;continuousObservations,
                            int[]&nbsp;discreteObservations)
                     throws java.lang.Exception</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html#setObservations(double%5B%5D%5B%5D,int%5B%5D)">MutualInfoCalculatorMultiVariateWithDiscrete</a></code></span></div>
<div class="block">Set the properties from which the mutual information should be computed.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html#setObservations(double%5B%5D%5B%5D,int%5B%5D)">setObservations</a></code>&nbsp;in interface&nbsp;<code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html" title="interface in infodynamics.measures.mixed">MutualInfoCalculatorMultiVariateWithDiscrete</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>continuousObservations</code> - observations of the joint continuous variables;
    first index is time or observation number, second index is variable number
    (the number of variables should be equal to the number of dimensions set
    in <a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html#initialise(int,int)"><code>MutualInfoCalculatorMultiVariateWithDiscrete.initialise(int, int)</code></a>.)</dd>
<dd><code>discreteObservations</code> - observations of the discrete variable; must be
    the same number of observations as supplied for continuousObservations.
    Each observation must lie in the range 0..base-1, where base was set by
    <a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html#initialise(int,int)"><code>MutualInfoCalculatorMultiVariateWithDiscrete.initialise(int, int)</code></a>.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</li>
</ul>
<a id="setObservations(double[],int[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setObservations</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setObservations&#8203;(double[]&nbsp;continuousObservations,
                            int[]&nbsp;discreteObservations)
                     throws java.lang.Exception</pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</li>
</ul>
<a id="ensureKdTreesConstructed()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ensureKdTreesConstructed</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;ensureKdTreesConstructed()</pre>
<div class="block">Internal method to ensure that the Kd-tree data structures to represent the
 observational data have been constructed (should be called prior to attempting
 to use these data structures)</div>
</li>
</ul>
<a id="computeAverageLocalOfObservations(int[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>computeAverageLocalOfObservations</h4>
<pre class="methodSignature">public&nbsp;double&nbsp;computeAverageLocalOfObservations&#8203;(int[]&nbsp;newOrdering)
                                         throws java.lang.Exception</pre>
<div class="block">Compute what the average MI would look like were the second time series reordered
  as per the array of time indices in reordering.
 The user should ensure that all values 0..N-1 are represented exactly once in the
  array reordering and that no other values are included here.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>reordering</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</li>
</ul>
<a id="computeAverageLocalOfObservations()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>computeAverageLocalOfObservations</h4>
<pre class="methodSignature">public&nbsp;double&nbsp;computeAverageLocalOfObservations()
                                         throws java.lang.Exception</pre>
<div class="block">Calculate the average MI in nats.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html#computeAverageLocalOfObservations()">computeAverageLocalOfObservations</a></code>&nbsp;in interface&nbsp;<code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html" title="interface in infodynamics.measures.mixed">MutualInfoCalculatorMultiVariateWithDiscrete</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a scalar for the average mutual information</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</li>
</ul>
<a id="computeLocalOfPreviousObservations()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>computeLocalOfPreviousObservations</h4>
<pre class="methodSignature">public&nbsp;double[]&nbsp;computeLocalOfPreviousObservations()
                                            throws java.lang.Exception</pre>
<div class="block"><p>Computes the local values of the MI,
  for each valid observation in the previously supplied observations
  (with PDFs computed using all of the previously supplied observation sets).</p>
  
 <p>If the samples were supplied via a single call such as
 <a href="#setObservations(double%5B%5D%5B%5D,int%5B%5D)"><code>setObservations(double[][], int[])</code></a>,
 then the return value is a single time-series of local
 channel measure values corresponding to these samples.</p>
 
 <p>Otherwise where disjoint time-series observations were supplied using several 
  calls such as <a href="#addObservations(double%5B%5D%5B%5D,int%5B%5D)"><code>addObservations(double[][], int[])</code></a>
  then the local values for each disjoint observation set will be appended here
  to create a single "time-series" return array.</p></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the "time-series" of local MIs in nats</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</li>
</ul>
<a id="computeFromObservations(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>computeFromObservations</h4>
<pre class="methodSignature">protected&nbsp;double[]&nbsp;computeFromObservations&#8203;(boolean&nbsp;returnLocals)
                                    throws java.lang.Exception</pre>
<div class="block">This protected method handles the computation of either the average or
 local MI (over parts of the total observations).
 
 <p>The method returns:<ol>
  <li>for (returnLocals == false), an array of size 1,
      containing the average MI </li>
  <li>for local MIs (returnLocals == true), the array of local MI values</li>
  </ol></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>returnLocals</code> - whether to return an array or local values, or else
  sums of these values</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>either the average MI, or array of local MI value, in nats not bits</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</li>
</ul>
<a id="computeSignificance(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>computeSignificance</h4>
<pre class="methodSignature">public&nbsp;<a href="../../../utils/EmpiricalMeasurementDistribution.html" title="class in infodynamics.utils">EmpiricalMeasurementDistribution</a>&nbsp;computeSignificance&#8203;(int&nbsp;numPermutationsToCheck)
                                                     throws java.lang.Exception</pre>
<div class="block">Compute the significance of the mutual information of the previously
 supplied observations.

 We destroy the p(x,y) correlations, while retaining the p(x), p(y)
 marginals, to check how significant this mutual information actually was.
  
 This is in the spirit of Chavez et. al., "Statistical assessment of
 nonlinear causality: application to epileptic EEG signals", Journal of
 Neuroscience Methods 124 (2003) 113-128 which was performed for transfer
 entropy.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html#computeSignificance(int)">computeSignificance</a></code>&nbsp;in interface&nbsp;<code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html" title="interface in infodynamics.measures.mixed">MutualInfoCalculatorMultiVariateWithDiscrete</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>numPermutationsToCheck</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the proportion of MI scores from the distribution which have
 higher or equal MIs to ours. (i.e. 1 - CDF of our score)</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd>"Chavez et. al., 'Statistical assessment of nonlinear causality:
  application to epileptic EEG signals', Journal of Neuroscience Methods 124 (2003) 113-128"</dd>
</dl>
</li>
</ul>
<a id="computeSignificance(int[][])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>computeSignificance</h4>
<pre class="methodSignature">public&nbsp;<a href="../../../utils/EmpiricalMeasurementDistribution.html" title="class in infodynamics.utils">EmpiricalMeasurementDistribution</a>&nbsp;computeSignificance&#8203;(int[][]&nbsp;newOrderings)
                                                     throws java.lang.Exception</pre>
<div class="block">Compute the significance of the mutual information of the previously
 supplied observations.

 We destroy the p(x,y) correlations, while retaining the p(x), p(y)
 marginals, to check how significant this mutual information actually was.
  
 This is in the spirit of Chavez et. al., "Statistical assessment of
 nonlinear causality: application to epileptic EEG signals", Journal of
 Neuroscience Methods 124 (2003) 113-128 which was performed for transfer
 entropy.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html#computeSignificance(int%5B%5D%5B%5D)">computeSignificance</a></code>&nbsp;in interface&nbsp;<code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html" title="interface in infodynamics.measures.mixed">MutualInfoCalculatorMultiVariateWithDiscrete</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>newOrderings</code> - the specific new orderings to use</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the proportion of MI scores from the distribution which have
 higher or equal MIs to ours.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html#computeSignificance(int)"><code>MutualInfoCalculatorMultiVariateWithDiscrete.computeSignificance(int)</code></a></dd>
</dl>
</li>
</ul>
<a id="computeLocalUsingPreviousObservations(double[][],int[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>computeLocalUsingPreviousObservations</h4>
<pre class="methodSignature">public&nbsp;double[]&nbsp;computeLocalUsingPreviousObservations&#8203;(double[][]&nbsp;continuousNewStates,
                                                      int[]&nbsp;discreteNewStates)
                                               throws java.lang.Exception</pre>
<div class="block"><p>Compute the local MI values for the given observations,
  using the previously set observations to compute the PDFs.
  That is to say, we will evaluate the required counts for each
  observation here based on the state space constructed from the
  previous observations only (not these ones). This is non-standard,
  and is not considered in the Kraskov paper. It is slightly unclear
  how to account for the fact that this observation itself is not
  in the data set used for computing the PDFs - I think though that
  it should be ignored, since the data point was not counted in its
  own counts in the standard version anyway.</p>
  
  <p><b>Importantly</b>, the supplied observations are intended to be new
  observations, not those fed in to compute the PDFs from. There would be
  some subtle changes necessary to accomodate computing locals on
  the same data set (e.g. not counting the current point as one
  of those within eps_x etc.). 
  </p></div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html#computeLocalUsingPreviousObservations(double%5B%5D%5B%5D,int%5B%5D)">computeLocalUsingPreviousObservations</a></code>&nbsp;in interface&nbsp;<code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html" title="interface in infodynamics.measures.mixed">MutualInfoCalculatorMultiVariateWithDiscrete</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>continuousStates</code> - multivariate observations of the continuous variable
    (1st index is time, 2nd is variable number)</dd>
<dd><code>discreteStates</code> - unvariate observations of the discrete variable</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a time series of the local mutual information values
  for each supplied observation</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</li>
</ul>
<a id="setDebug(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setDebug</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setDebug&#8203;(boolean&nbsp;debug)</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html#setDebug(boolean)">MutualInfoCalculatorMultiVariateWithDiscrete</a></code></span></div>
<div class="block">Set whether to print extra debug messages</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html#setDebug(boolean)">setDebug</a></code>&nbsp;in interface&nbsp;<code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html" title="interface in infodynamics.measures.mixed">MutualInfoCalculatorMultiVariateWithDiscrete</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>debug</code> - whether to print extra debug messages</dd>
</dl>
</li>
</ul>
<a id="getLastAverage()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLastAverage</h4>
<pre class="methodSignature">public&nbsp;double&nbsp;getLastAverage()</pre>
<div class="block">Return the MI last calculated in a call to <a href="#computeAverageLocalOfObservations()"><code>computeAverageLocalOfObservations()</code></a>
 or <a href="#computeLocalOfPreviousObservations()"><code>computeLocalOfPreviousObservations()</code></a> after the previous
 <code>#initialise()</code> call.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html#getLastAverage()">getLastAverage</a></code>&nbsp;in interface&nbsp;<code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html" title="interface in infodynamics.measures.mixed">MutualInfoCalculatorMultiVariateWithDiscrete</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the last computed average mutual information</dd>
</dl>
</li>
</ul>
<a id="getNumObservations()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getNumObservations</h4>
<pre class="methodSignature">public&nbsp;int&nbsp;getNumObservations()</pre>
<div class="block">Get the number of samples to be used for the PDFs here 
 which have been supplied by calls to
 <a href="#setObservations(double%5B%5D%5B%5D,int%5B%5D)"><code>setObservations(double[][], int[])</code></a>,
 <a href="#addObservations(double%5B%5D%5B%5D,int%5B%5D)"><code>addObservations(double[][], int[])</code></a>
 etc.
 
 <p>Note that the number of samples may not be equal to the length of time-series
 supplied (i.e. where a <a href="#PROP_TIME_DIFF"><code>PROP_TIME_DIFF</code></a>
 is set).
 </p></div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html#getNumObservations()">getNumObservations</a></code>&nbsp;in interface&nbsp;<code><a href="../MutualInfoCalculatorMultiVariateWithDiscrete.html" title="interface in infodynamics.measures.mixed">MutualInfoCalculatorMultiVariateWithDiscrete</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the number of supplied observations</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</body>
</html>
